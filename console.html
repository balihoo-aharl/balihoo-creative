<html>
  <head>
    <title>Balihoo | Web Designer Console</title>
    <style>
      body {
        margin: 0px;
        background-color: #efefef;
      }
      #toolbar {
        margin: 0px;
        padding: 15px;
        border: 0px;
      }
      iframe {
        border: 0px;
        border-top-color: black;
        border-top-style: inset;
        border-top-width: 3px;
        width: 100%;
        height: 100%;
      }
    </style>
  </head>
  <body>
    <div id="toolbar">
      <input id="nav" type="text" size="60" value="/"/>
    </div>

   <script>

    nav.onkeydown = function(evt) {
      var nav = document.getElementById('nav');
      if(evt.keyCode == 13)
        navChange(nav.value);
    }

    function navChange(location) {
      var iframe = document.getElementById('contentFrame');
      var nav = document.getElementById('nav');

      if(location === null)
        nav.value = iframe.contentWindow.location;
      else
        iframe.contentWindow.location = location;
    }

    window.onload = function() {
      var iframe = document.getElementById('contentFrame');
      var es = new EventSource('/$console')
      es.onmessage = function(event) {
        e = JSON.parse(event.data);
        if(e.event === 'refresh') {
          iframe.contentWindow.location.reload();
        } else if(e.event === 'reload') {
          es.close();
          window.location.reload();
        } else if(e.event === 'navigate') {
          iframe.src = e.data.path;
        }
      }
    }
    </script>

    <iframe id="contentFrame" onload="navChange(null);">
      Your browser does not support iframes. Bummer.
    </iframe>

   </body>
</html>

